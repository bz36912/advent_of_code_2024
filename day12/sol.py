data = """CIISIIQQVZZZZZZOOOTTTTTTTTTTTTTTTDDJAAAAADDDDDDDDDDVVVVVVVVMMMMMMMMMMHHHHHJJJHHHHHHVVVVVVVVVVVVVVVVVVVNNNNNNNNNNNNNNNNNNOOOOOOOOOOOOOOOOOOOO
CIIIIIIQVVVZZOOOOOTTTTTTTTTTTTTTDDDDDAGAASDDDDDDDDDDVVVVVVVMMMSMMMMMHHHHHHHJHHHHHHVVVVLLLVVVVVVVVVVVVVYNNNNNNNNNNNNNNNNNNOOOOOOOOOOOOOYYYYYO
CCCIIIXVVVVVOOOOOOOTTTTTTTTTTTTTTDDDDDGGAAAAADDDDDDDVVVVVVVVVSSSSMMMHHHHHHHHHHHHHVVVLLALLVVVVVVVVVVVVVYNNNNNNNNNNNNNNNNNOOOOOOOOOOOYOYYYYYYY
CIIIIIXVCVVVVOOOOOOTTTTTTTTTTTTTDDDDDDDAAAAAAADDDDDDDVVVVVVVVVSSMMMMMMHHHHHHHHHHHHVVLLLLLVVVVVVVVVVVVYYNNNNNNNNNNNNNNNNNOOJJJOOOOYOYYYYYYYYY
CIIIIICCCCVVOOOOOOOOTTTTTTTTTDTTDDDDDDDAAAAAAADDDDDDDVVVVVVVVVVSSSSMMMHHHHHHHHHHHHVLLLLLLLVVVVVVVVVVVYYYNNNNNNNNNNNNNNNJJJJJJJJJYYYYYYYYYYYY
CCCCZZZCCCVOOOOOOOOHHHTTTTTTTDDDDDDDDDDDDAAAAADDDDDDDVVVVVVVVVSSSWWCMMHHHHHHHHVVVLLLLLLLLLVVVVVVVVVVVVVYNCNCCNNNNNNNNNNJJJJJJJJJBYYYYYYYYYYY
CCCCZZZCCCCOOOOOOOOOHHHHTTTTTDTDDDDDDDDDDAAAPDDDDDIIIVZZZVVVVVSSSCCCCCRHHHHHVVVVVLLLLLLLLVVVVVVVVVVVVVVVCCCCCNNNNNNNNGGJJJJJJJJJYYCYYYYYYYYY
CCCCCZCCCCCOOOOOOOOHHHHHHHTTTDTDDDDDDDDDDDDDDDDDDIIIZZZZZVVVVSSSCCCCCCCHHHHHHHHVRLLLLLLLLVLVVVVVVVVVVVVCCCCCCNCNNPPJJJJJJJJJJJJJJJJYYYYYYYYY
CCCCCCCCCCCCOOOOOOHHHHHHHHTTTDTDDDDDDDDDDDDDLLLIIIIIZZZZZIVVSSSSSCCCCCCRHHHHHHHVLLELLLLLLLLVVVBBBBBVVEVCCCCCCCCNPPPJJJJJJJJJJJJJJJJJYYYYYYYY
CCCCCCCCCCCCOOOOOHHHHHHHTTTTTTTDHDCCCCCCCCCDLLZZZZZIZZZZZISVSSSSSSCCCCCRHCHCCGGGGLLLLLLLLLLLLVVBBBBBVVVCCCCCCCCNCCPJJJJJJJJJJJJJJJJJYYYYYYYY
CCCCCCCCCCCOOOOOOOFHHHHTTTTTTDCCCCCCCCCCCCCDDLZZZZZIZZZZZISSSSSSSCCCCCCCCCCCCCCCGGLLLLLZLLYLLVVVBBBBVVLJCCCCCCCCCXJJJJJJJJJJJJJJJYYYYYYYYYYY
CCCCCCCCOOOOOOOOOOOQQQHTTTTLTTCCCCCCCCCCCCCCCCZZZZZZZZZZZISSSSSCCQQCCCCCCCCCCCCCGGLLLLLLLYYVVVBBBBBLLLLJJJJJCCCCCXJJJJJJJJJJJJJJJYMMMYYYYYYY
CCCCCCCOOOOOOOOOOOOQQLLTTLLLLCCCCCCCCCCCCCCCCCZZZZZZZZZZZSSSSLCCCCCCCCCCCCCCGGGGGYSYVVYLYYYVVVLBBBBLLLLJJJJJJJJCCXZJJFJJJJJJJHHHJJMMMMMMMMMY
CCCCCCCCOCOOOOOOOOLLLLLLTLLLLCCCCCCCCCCCCCCCCCZZZZZZZZZZMSSSSLCCCCCCCCCCCCCGGGGGYYSYYYYYYYNNJLLLLBBLLJJJJJJJJJJXXXZXJJJJJJJJHHHHMMMGMMMMMMMY
CCCCCCCCCCCOOOOOOOZLLLLLLLLLLCCCCCCCCCCCCCCCCCZZZZZZZZZZSSSSSLCCCCCCCCCCCCCXXXXGYYYYYYYYYYYJJJJJLLLLLJJJJJJJJJJXXXXXXJJJJJJJHHHHMMMMMMMMMMMX
CCCCCCCCCCCOOOOOOOLLLLLLLLLLLLLLLLCCCCCCCCCCCCZZZZZZZZZZSSSSSSCCCCCCCCCCCCEXXXXYYYYYYYYYYYJJJJJJLLLLLJJJJJJJJJXXXXXXXXXOJJJJHHHHHMMMMMMMMMXX
CCCCCCCCCCCOOOOOOOALLLLLLLLLLLLLLLCCCCCCCCCLLLLZZZZZZZZZSSSSSSSCCCCCCCCCCCXXXXXYYYYYYYYYYYJJJJJJLLLLJJJJJJJJJJXXXXXXXXXXJJJHHHHHMMHMMMMMMQXX
CGGCCCCCCCCOOOOOOOALLLLLLLLLLLLLLLLLLLLRRLRLLLLLLLLLISSSSSSSSSCCCCCCCCCCCXZXXXXYYYYYYYYYYYJJJJJJJLLJJJJJJJJJJXXXXXXXXXXXXXHHHHHHHHHHMMMMMQQQ
FGGGGGGCCCCOOOOOOOLLLLLLLLLLLLLFFFFLLRRRRRRLLLLLLLLIIISSSSSSSSCCCCCCCCNCXXXXXXXXXYYYYYYYYYYYJJJJJLLJLJJJJJJJJJXXXXXXXXXXXXHHHHHHHHHHHHHMMQQQ
GGAGGGGGGCGGOOOOOOOLLLLLLLLLLLLLFFFFFRRRRRRLLLLLLLLIIIISSSSSSSFFCCCACAXXXXXXXXXXXXYYYYYYYYYBJJJJLLLLLJJJJJXXJXXXXXXXXXXXXXXXHHHHHHHHHHHQQQQQ
UUGGGGGGGGGGGOOOOOOOOLLLLLLLLLLFFFFFJJRRRRNLLLLLLLIIIISSSSSSSSFCCHCAAAXXXXXXXXXXXYYYYYBBYYBBJJJJLLJJLJJJJJXXXXXXXXXXXXXXXXZMHHHHHHHHQQQQQQQQ
UUGGGGGGGGGGOOOOOOOOLLLLLLLLLFFFFFFFJJRRRRNLIIIIIIIIIIISZSSSSSHHHHCAAAAAAXIXXXXXXYYYYYBYYYBBJJJJLJJJJJJJJJJXXXXXXXXXXXXPMGMMHHHHHHHHQQQQQQQQ
UUGGGGGGGGGGOOOOOOOOSSLLLLLFLFFFFFFFFFIIORRIIIIIIIIIIIISSSSSSHHHHHHHHHAAAXXXXXXXLLYYYBBBBBBJJJJJJJJJJJJJJJXXXXXXXXXXXXPPMMMMMHHHHHHHHQQQQQQQ
GGGGGGGGGGGOOOOOOOOOOLLLLLLFLLFFFFFFFIIIRRLIIIIIIIIIIISSSSSSSSHHHHHHHHAAAXXXXXXXLYYBBBBBBBBBJJJJJJJJJGGJJJOXXXXXXXXXDXMMMMMMMHHHHHHHHQQQQQQQ
QGGGGGGGGGGOOOOOOOOOOLOOLLFFFFFFFFFFFXIISILIIIIIIIIIISSSSSSSSSAHHHHHMHAAAAXXXXXXLLLBBBBBBBBJJJJJJJJJJJGGGGGXXXXXXXXXDDDMMMMMMHHHHHHHHHQQQQQQ
QGGGGGGGGGGGOOOOOOOOOOOOLLFFFFFFFFFFFFIFIIIIIIIIIIIISSSSSSSSSHAHWHHHHHHAAINXXXXLLLLLLLBBBBBJJJJJJJJJGGGGGGGXXTTXXXXXDDMMMMMMMMHHHHHHHQQQQQQK
UUGGGGGQGGOOOOOOOOOOOOOOFFFFFFFFFPFFFFSSHSIIIIIIIIIISHSSSSSSHHHHHHHHHHHIAIIIXRLLLLLLLLBBBBBBBJJJJJJJGGGGAGGGGXXXHXXDDDBMMMMMMXHHHHHHHHHKKKKK
UUGGGGGUUUUOOOOOAOOOOOOOOFFFFFFFFFFSSSSSSSAAAAAAAAAASSSSSSSSHHHHHHHHHHHIIIIIILLLLLLLLLLBBBBBJJJJJJJTAAFGAGGGGGGGGDDDBBBMMMMMXXXXHHHHHHHKKKKK
UUGGUUGUUUUOOOOOOOOOOOOOOFFFFFFFFFFSSSSSSIAAAAAAAAAASSSSSSSSSSSHHHHHIIWIIIIIILLLLLLLLLLLBBBBJJJJJJAAAAAAAAGGGGGGGGDGBBBBSMMMXXXXHHHHKHHKKKKK
UUUUUUGUUUYOOOONNNOOOOOOOOFFFFFFFFSSFSSIIIAAAAAAAAAASSSSSSSSSSSSHHHIIIIIIIIIILLLLLLLLLLLBBBBJJJJAAAAAAAAAAGGGGGGGGGGBBBSSMMMMXXXXHHKKKHKKKKK
UUUUUUUUUYYOOOONNNOOOOOOOOOOFFFFFFFFFFIIIIAAAAAAAAAASSSVVVVSSSKKKKKKKIIIIIIIILLLLLLLLLLLLRBJJJJAAAAAAAAAAGGGGGGDGDDBBBSSSSMMMXXXXXHKKKKKKKKK
UUUUUUUUUUOOOOOOOOOROOOOOOOOJFFFFFFFIIIIIIAAAAAAAAAAXSVVVVVSSSKKKKKKKAIIIIIIILLLLLLLLLLLLJJJJJJJAAAAAAAAAGGGGGGDDDDDBBBBSXXXXXXXKKKKKKVVKKKK
UUUUUUUUUUOOOOORRROROOOOOOOOJJFFFFFIIIIIIBAAAAAAAAAAAXVVVVVSSSKKKKKKKIIIIIIIILLLLLLLLSSLLLJJJJJJAAAAAAAAAAAGGGGDDDDDFBBBBXXXXXXKKKKKKKKVVVKK
UUUUUUUUULOOOORRRRRRROOOOOOOJJFFFFFIIIIIIBAAAAAAAAAAAXXVVVVVSSKKKKKKKIIIIIIILLLLLLLLLSSSLSSJJJJPPAAAAAAAAAAAAGGGDDDFFFBBBNNXXXKKKKKKKKKVYVVV
UUUUUUUUJJJPPOOJJJRROOOOOOJJJJUUFFFIIIIIIBAAAAAAAAAAAXLLVLLVSSKKKKKKKAAIAIIILLLLLLLLLLSLLPJJRJPPPPAAAAAAAAAAAAGGTDDDDBBBBNNNNXKKKKKKKKKVVVVV
UUUUUUUUJJPPPPPQTJJRRROOOOJJJUUUFUUUIIIBBBAAAAAAAAAARLLLLLLLLLKKKKKKKAAAAAILLRLLLLLLLLPPPPPJJPPPPPAAAAAAAAAAAAATTDDUUBBBBNNNKSSKKKKKKKKVVVVV
UUUUUUUUUTPPPPQQTTJRRRRORJJJJUUUUUUUUIIBBBAAAAAAAAAARLLLLLLLLLKKKKKKKAAAAAARLRLLLLRRRLLPPPPPPPPPPPPAAAAAAAAAAAAATTDDUUBQQNNKKKKKKKKKKVVVVVVV
UUUUUUUUTTPPPPQQQQRRRRRORJJJJUUUUUUUUUUYBBAAAAAAARRRUULLLLLLLLKKKKKKKAAAAAARRRRLRRRRRLRRPPPPPPPPPAAAAAAAAAAAATATTTTTUTBQQQNNKKKKKKKKVVVVVVVV
UUUUUUTTTTTPPPQQQQQQRRRRRRJJUUUUUUUUUUUBBBBBBRAAARRRRULLLLLLLLKKKKKKKAAAAARRRRRRRRRRRRRRPPPPPPPPPAAAAAAAAAAATTATTTTTTTOKKKNNNNKKNTKKVVVVVVVV
UUTUTTTTTTPPPPPQQQQQQQRRBRJJUUUUUUUUUUUDBBBBRRAAARRRRRLLLLLLLLLLLLLAAAAAARRRRRRRRRRRRRRRPPPPPPPPPPPAAAAAAAAAATTTTTTTTTKKKKKNNNNNNKKKVVVVVVVV
UTTTTTTTTTPPPPQQUQQQQQQRRRRJUUUUUUUUUUUBBBBBBBRRRRRRRRRQLLLLLLLLLLLLAAAAAARRRRRRRRRRRRRRRRRRPPPPPPPAAAAAAAAAATTTTTTTTTKKKKKNNNNNNNNVVVVVVVVV
TTTTTTTTTTPPPPQQQQQQQQRRRRRJUUUUUUUUUUUTTBBBBAARRRRRRRRQLLLLLLLLLLLLAAAAAAAFRRRRRRRRRRRRRRRPPPPPPPPPAAAAAAAVAVTTTTTTTTKKKKKKNNNNNNNVVVVVVVVV
TTTTTTTTTTPPPPQQQQQQQQQRZZRRHUURUUKURRRBBBBAAARRRRRRRRRQLLLLLLLLLLAAAAAAAAATRRRRRRVRRRRRRPPPPPPPPPPPTAATTAAVVVTTTTTTKKKKKKKKNNNNNNNVVVVVVVVV
TTTTTTTTPPPPPPPQQQQQQQQQZZRRRRRRRUUURRRRBBBAAARRRRRRRRQQLLQLLLLLLAAAAAAAAATTRRTRTVVRRRRCCCPPPPPPZZPPPPTTTVVVVVVTVTTTTKKKKKKKNNNNNNNVVVVVVVVV
TTTTTTNUPPPUUPPPQQQQQQQQZZRRRRRRRRUURRRRRRRRRRRRRRRRRRQQQQQLLLLLLAAAAAAAATTTTTTTTVVRRRRRCCPPPPPPZTPPTTTTTQQVVVVVVVVKKKKKKPPKKGGGGNVVVVVVVVVV
TTTTTTNUUUUUUPPQQQQQQQQQQQUURRRRRRRURRRRRRRRRRRRRRRRRQQQQQQQLLLLLLLAAAAAATTTTTTTVVVVVRRVCCCPCCCPPTTPTTTTTQQQVVVVVVVKKKUKKPPPPGGGGTVVVVVVVVVV
TTNNNNNUIUUUUUPPQQQQQQQQQUUURRRRRRRRRHHHRRRRRRRRRRRRRRQQQQQLLLLLLLLXAAAAATTTTTTTVVVVVRTVCCCCCCCPPTTPTTTTTTQQVVVVVVVKKKKKPPGGGGGGGTVVVVVVVVVV
NTTNNNUUUUUUUUUUUTQQQQTQUUUUURRRRRRRRHHRRRRRRRRRRRRRRRQQQQQLLLLLLLLAAAATTTTTTTTTTTVVVVVVVCCTCTTTTTTTTCTTTQQQQVVVVVVKKKKVPGGGGGGGGVVVVVVVVVJJ
NTTNUUUUUUUUUUUUUUHUTTTTXXUXURRRRRRRRHRRRRRRRRRRRRRRRRRQQQQQLLLLLLFAAAAAFFTTTTTTTTVVVVVVVCCTTTTTTTTTTCTTZCQQQVVVVVVVKVVVVHHGGGGGGVVVVVVVVJJJ
NNNNNUUUUUUUUUUUUCUUUTTTXXXXURRRRHRRRHRRRRRRRRRRRRRRRRRRQQQLLLLLFFFFAAAAFFTTTTTTTTVVVVVVVVCTTTTTTTTTTCCCCCCCVVVVVVVVVVVVQQQQGGGGGGVVVVJJJJJJ
NNNNNUUUYUUUUUUCCCUUUUUXXXXXXYYRYHHHHHRRRHRRRRRRRRRRRRRRQQQLFFFFFFFFAAAFFTTTTTTTTEVVVVVVVCCCCNNTTTTTTCCCCCCCJVVVVVVVVVQQQQQGGGGGGGGGGJJJJJJJ
NNNNNNUUUUUUUUCCCCCUUUUXXXXXYYYRYYHHHHRHHHRRRRRRRRRRRRRRQQFFFFFFFFFFFFFFFFTTTTTTTEVVVVVVCCCCCCNTTTTTCCCCCCCJJVVVVVVVVQQQQQQQGGGGGGGGUJJJJJJJ
NNNNNNNUUUUUUUCCCCUUUUUXXXXXYYYYYYYHHHRHHHHRRRRRRRRRRRQQQFFFFFFFFFFFFFFFFFFTTTTTEEEEVVCVCCCCCNNNNTTTCCCCCCCCJCVVVVVVVVQQQQQQQQQGGGUQUUUUUUJJ
NNNNNNNUUUUUUUCCCCUUUXUXXXXXYYYYYYYHHHHHHHHHHHRRRORRQQQQQFFFFFFFFFFFFFFFFEEUTTEEEEECCCCVCCCCCCNNTTTTCCCCCFCCCCCVVVVVVVVQQQQGGQGGGGUUUUUUJJJU
NNNNNNNNUUUUUCCCCUUUUXXXXXXLYLLLYYYHHHHHHHHHHHRRQQRQQQQQQFFFFFFFFFFFFZFFFEEEEEEEEEEEECCCCCCCNNNTTTCCCCCCCCCCCCVVVVVVVVVVNQQGGGGIGUUUUUUUUUUU
NNNNNNNJDDUUUCCUUUUUUXXLXXLLLLLLLYYYHHHHHHHHHHRRQQQQQQQQQFFFFFFFFFFZZZFFFEEEEEEEEEEECCCYCCCNNNNNNCCCCCCCCCCCCIIVVVVVVVVVQQQGGIGIIIUUUUUUUDEE
JJNNNJJJJJUQUCCCCUUXXXLLLLLLLLLLLLLLFFHHHHBBBRRRBQQQQQQQFFFFFFFFFZFFVZZFFEEEEEEEEEEEYYYYYYCCYNNNNUUCCCCCCCCCCCLLVVVVVVVVQFFIIIIIIIIIUUBBEEEE
JJJNNJJJJJUJUCCCCUUUXXLLLLLLLLLLLLFFFHHHHBBBBBBBBBQQQQQQQQFFFFFFZZFZZZZZEEEEEEEEEEEEEYYYYYYYYUUNUUUUUUCCCCCLLLLLLLLLVVFFFFFFIIIIIIIIUUBEEEEE
JJNNJJJJJJJJJCCCCCUCXXLLLLLLLLLLLLFFFHHHHBBBBBBBBBBBQQQQQFFFFFFZZZZZZZZZEEEEEEEEEEEEEIYYVVVUUUUUURUUUUCCCCCLLLLLLLLLLLFFFFFFIIIIIIJJJJJEEEEE
JJJJJJJJJJJJJCCCCCCCXCLLLLLLLLLLLLFFFHHHHHHBBBBBBBBBIBQQQQFFWWZZZZZZZZZEEEEEEEEEEEEEEEYYVVVDUUUUURRUUUACCCCLLLLLLLLLELFFFFFFIFIIJIJJJJEEEEEE
JJJJJJJJJJJJCCCCCCCCCCCLLLLLLLLLLLFFFFFHHHBBBBBBBBBBBBQWWQWFWWWWZZZZZZZZZZEEEEEEEEEEEWYYVVVUUUURRRRRUUUCBBLLLHLPLLLLLFFFFFFFFFIIJJJJJJEEEEEE
JJJJJJJJJJJCCCCCCCCCCCCLLLLLLLLLLLFHFHHHHHHBBBBBBBBVBWWWWWWWWDDDDDZZZZZZZZEEEEEEEEEEEWWWVVVWUVVVVVRRRUUBBLLLLLLLLBLPPPFFFFFFJJIIJJJEEEEEEEEE
JJJJJJJJJJJCCCCCHHCCCCCLLLLLLLLHHHHHHHHHHHHBBBBBBBBVFFWWWWWDDDDDDDZZZZZZZZXXEEEEEEWWEWWWVVVWUVVVVVBBBUUBLLLLBBBBBBBPPPFFFFJJJJJJJJJJEEEEEEEE
JJJJJJJJJJJCCCCCHHHCCCCCCCLLLLLHHHHHHHHHHHHHIBBBBHBVFFFWWWJDDDDDDRZZZZZZZZXXXEEEUEEWWWPPVVVWWVVVVVQBBUBBBBBBBBBBBBBBPPPPPPPSJJJJJJJJEEEEEEEE
JJJJJJJJCJRRCCCCHHHHHCHCCCCLLLLLHHHHHHHHHIIIIBHHHHHFFFFWWDJJDDDDDDZZZZZZZZZUXUUUUUUPPPVVVVVVVVVVVVPBBBBBBBBBBBBBBBBBPPPPPPPJJJJJJJJEEEEEEEEE
PJJJJJJCCRRRRCCHHHHHHHHCCCCLLLLLHHHHHHHHHHHIIIIIIIHHHFWWWDJJJDDDDDDZZZZZOOUUUUUUUUUPPPVVVVVVVVVVVVPBBBBBBBBBBBBBBBBPPPPPPPPPJJJJJJJLLEEEEEEE
PJJJJRRRRRRRRRHHHHHHHHHCCCCLLLMHHHHHHMHHHHHIIIIIIIFFHFFFWDJJDDDDDDDDZOOOOOOOUUUUUUUPVVVVVVVVVVVVVVPBBBBBBBBBBBBBBBBPPPPPPPPPPJGJJJJLLLLLLEEM
PPJRRRRRRRRRRRHHHHHHHHCCCCCEEEKHKKHKHMHMHHIIIIIIIIFFFFJFDDDDDDDDDDDOOOOOOOOOUUUUUUUPVVVVVVVVVVVVVVPBBBBBBBBBBBBBBBBBBPEPPPOPGGGGGDJLDLLLLMMM
PPRRRRRRRRRRRRRRHHHHHHCCCCEEEKKKKKKKMMMMMMIIIIIIIIFFFFFFFDDDDDDDDDDOOOOOOUUUUUUUUUUUVVVVVVVVVVVVVVABBBBBBBVVVBBBBBBBBPPPPPPPGGGGDDDDDDLLMMMM
PPRRRRRRRRRRRRRRRRRHEECCCEEEKKKKKKKKCMMMMMIIIIIIIIFFFFFFFDDDDDDDDDOOGGGOOUUUUUUUUUUUVVVVVVVVVVPVVVAAABBBBVVVVVBBBBBBPPPPPPPPGGHHDDDDLLLLMMMM
PRRRRRRRRRRRRRRRRRREEEECCEEEKKKKKKKCCKMMMIIIIIIIIIIFFFFFFDDDDDDDDDOOOGGGGGUUUUUUUUUPVVVVVVVVVVPVVVAAAABBBBVVVVVVVVVVSSSPPPGGGGHHGDGDDLLLMMMM
PPPPRRRRRRRRRRRRRRREEEEEEEEEKKKKKKKKKKMMMEIUUIIIIIIFFFFFCDDDDDDDDDOOOGGGGGUUUUUUUUUPVVVVVVVVVVQQQQAAAABBBBVVVVVVVVVPVSSPPPPPGGGGGGGLLLLLMMMM
PPPPRRRRREERRRRRRREEEYYYYYYYYKKKKKKKKKMMMESUSSSSIILFFFFFCCDDDDDDDDOOOGGGGGUUUUUUUUUPVVVVVVVVVVQQQQAAABBBBBYVVVVVVVVVVSSSSSSGGBGGGGLLLMMMMMMM
PPPPRRRREEEEERRRRREEEYYYYYYYYKKKKKKKKKMMMESSSSSSSIISFFCCCJNDDDDDDDDOOGGGGGGGUUUUUUGGPVVVVGPPPQQAAAAAABBBBBBBJVVVVVVVVVVVSSGGGLLLLLMMMMMMMMMM
PPPPPPREEREEERRRRRREYYYYYYYYYYKKKKKKKKKMEESSSSSSSSSSSSCCJJJDDNDDDDOOOYGGGGGGGUUGGGGGGVVVVPPPPQQQAAAAAABBZZVVVVVVVVVVVVVVSSSSSLLLLLMMMEMMMMMM
PPPPPESEEEEEEERERRRRIYYYYYYYYYKKKKKKKKKSSSSSSSSSSSSSSSCCJJCDDDDDDDDYYYGGGGGGGGGGGGGGGGGGGGPPQQAAAAAAAAAAZZZZVVVVVVVVVVSSSSSLSLLLLLLJLMMVVMMP
PPPPEEEEEEEEEEEEERRKYYYYYYYYYYYKKKCKKKKCCSSSSSSSSSSSRCCCJJJDDDDDYUUUUYYYGGGGGGGGGGGGGGGGGGAAAAAAAAAAAAAAAZZZZZVZCCCVVVVSSLLLLLLLLLLLLLVVVVMM
PPPPEEEEEEEEEEEEEERRRLYYYYYYYYYKKCCCCCCCSSSSSSSSSSSSRCCCCJJDDDDDYYYYYYYYYGGYGGGGGGGGGGGGGGGAAAAAAAAAAAAAAAAZZZZZZCCZZVFLSLLLLLLLLLLLLLVLVVVV
PPPPEEEEEEEEEEEEEELLLLLYYYYYYYYCCCCCCCCCSSSSSSSSSSSSRRRRRJSDCDDDDJJYYYYYYYYYYYYGGGGGGGGGGGGAAAAAAAAAAAAAAAZZZZZZZZCZLVVLLLLLLLLLLLLLLLVLLLUU
PPPEEEEEEEEEEEEEELLLLLLLYYYYYCCCCCCCCCCCCSSSSSSSRRRRRRRRRRRRRDNNDYYYYYYYYYYYYYYGGYGGGGGGGGGAAWWAADAAAAAANNNZZZZZZZZZLLVLLLLLLLLLLLLLLLLLUUUU
SPPEEEEEEEEEEEEELLLLLLLLYYYYCPCCCCCCCCCCCCCCSSSRRRRRRRRRRRRCCDPPPYYYYYYYYYYYYYYYYYYYYGGGGGGGWWAAADDAAAAANNNZZZZZZZZZZLLLGGGLLGLLLLLLULLLUUUH
SPPEEEEEEEEEEEEELLLLLLLLVVYYCCCCCCCCCCCCCCCCCSSRRRRRRRRRRRRCCCPPYYYYYYYYYYYYYRYYYYYYYGGGGGGIAAAAADDAAAAANZZZZZZZZZZZZGGGGGQQQGLLLLLLUUUUUUUU
SSNEEEEEEEEEEEEEELLLLLLLLVVCCCCCCCCCCCCCCCCSSSSRRRRRRRRRRRRRRPPPPPPYSYYYYYYYYRRRYYYYYGGGGGIIIEEDDDDEAANNNZZZZZZZZZZZZZGAGGGGGGGLLLLLUUUUUUUU
SNNNNNNNEEEEBBBBBBLLLLLLLVVVVVVCCCCCCCCCCCCSSSSRRRRRRRRRRRRJJPPPPPPPSSSYYYYYRRRRRRYYYGYYYZZZZZZZZZDEAAANNZZZZZZZZZZZZAAAGGGGGGGLLLLLUUUUUUUU
SNNNNNNNEEESSBBBBBLLLLLVVVVVVVVCCCCCCCMCCCSSSSSRRRRRRRRRRRRPPPPPPPPPPPSYYYYYRRRRRRYYYYYYYZZZZZZZZZJJJJANNZNZZZNZZZIIIGGGGGGGGGGGLLLKKUUUUUUU
SSNNNNNNSEEEBBBBBBEEELVVVVIVVVVMIICCCMMCCCCSSSSRRRRRRRRRRRAPPPPPPPPPPPSSSRRRRRRRRYYYYYYYYZZZZZZZZZZZZZNNNNNNNNNNIIISIIGGGGGGGGFFLLKKKKUKUUUY
SSNSSNNSSSSBBBBBBBBBGGGGGVIIVMMMICCCMMMMMMSSSSSRVRRRRRRIRRPPPPPPPPPPPRRSSRRRRRRRRYYYYYYYYZZZZZZZZZZZZZEEENNNNNNNIISSSGGGGGGGGGGGLLKKKKKKXXXX
SSSSSSSSSSSSBBBBBBBGGGGGVVVIIMMMMMMMMMMMMMMSSSSSSSRRRRRRRPPPPPPPPPPRRRRRRRRRRRRRRRYYRRYYYZZZZZZZZZZZZZEEENNNNNNNNNSSSSGGGGGGGGGDLKKKKKXXXXQX
SSSSSSSSSSSSBBBBBBBGGGGGGGGGGMMMMAMMMMWWMMMMSSSKSSRRRRRRPPPPPPPPPPPPTRRRRRRRRRRRRRRRRRYYYKKKZZZZZZZZZZEEUNNNNNNNNNSSSUUUUUUUUUGGXKKKKKXXXXXX
SSSSSSSSSSSSBBBBBBBGGGGGGGGGJMMMAAAMMWWWWMMMMWSSIIRRRRRRRPPPPPPPPPPPPRRRRIRRRRRRRRRRRRYYYOKKZZZZZZZZZZEEUUNNNNNNNNSSSUUUUUUUUUGGKKKKKKXXXXXX
SSSSSSSSSSBBBBBBBBBGGGGGGGGGMMMMAAAMMJJWWWMMMSSSIIIIRRRPPPDDDPPPPDPPPIIIIIRRRRRRRRRRRHYOYYXKZZZZZZZZZZEUUUNNNNNNSSSSSUUUUUUUUUGKKKKKKKXXXXXX
SSSSSSSSSSBBKBBBBBBGGGGGGGGYYYYYYYJJJJJJJMMMMMSLLLIIRRRPPPDDDDDDDDDIIIIPIIIRRRIRRRRRRRRYYYYKZZZZZZZZZZUUUUTTTUNNSSSSSUUUUUUUUUZKKKKKKKXXXXXX
SSSSSSSSSSSSBBBXXBBGGGGGGGYYYYYYYYJJJJJJJJJJJLLLIIIIRRRPPPDDDDDDDDDDIIIIIIIRRRIRRRRRRRRRYYQKRREEEZZZZZQQQQUUUUUSSSSSSSZUUUGGZZZKSKKKKKXXXXXX
SSSSSSSSSSAABBXXXXGGGXEGGYYYYYYYYYYJJJJJJJJJJLLLIIIIRRPPPPDDDDDDDDIDIIIIIIIIIIIRRRRRRRRRRERRRREEEZZZZZQQQQUUUUUUUUUUUUUUUUZZZZZSSSSSSSXXXXXX
SSSSSSSSSAAAXXXXXXXXXXXYYYYYYYIIYPPPJJJJJJJJLLLLLIIIRRRPPPDDDDDDDDIIIIIIIIIIIIIIIRRRRRRRSRRRRPEEEZZZZZQQQQUUUUUUUUUUUUUUUUZZZZZSSSSMMSXXSEXL
SGSSSSSSAAAAXXXXXXXXXXZYYYYBYYPPPPPJJJJJJJLLLLLLIIIIILLPPPPDDDDDHIIIIIIIIIIIIIIIIRRRRRRRRRRRRRREEEEQUQQQQQUUUUUUUUUUUUUUUUZKZZSSSSSSSSXSSSLL
GGSSSSSAAAAAAXXXXXXXXXZYYYYYYYPPPPSXMJJLLLLLLLLLLLIIIILPPPDDDDDDHDIIIIIIIIIIIIIYIRRRRRRRRRRRRRREEEEEQQQQQQUUUUUUSSSWWKKKKKKKZZSSSSSSSSSSSSLL
GGGSSSSAAAAAAXXXXXXXXXXXYYYYYPPPPXXXXXJZXLLLLLLLLLLIIILLLLLDDDDDDDAAIIIIIIIIIIIIRRRORRRRRRRRRRREEESEUQQQQQUUUUUUNSSSWKKKKKKKKSSSSSSSSSSSSSLL
GGGSSSSAGAAAGXXXXXXXXXYYYYYYYPPPPPPXXXXXXXBLLLLLLLLIIILLLLLLDDDDLWLAIIIJIIIIIIIIRRROYYRRRRRRRREEWRREUQQQQQUUUUUUNSSWWKKKKKKKKSSSSSSSSSSSSSLL
GGGGGSSAGAAAGXXXXXXXXXXXYYYYXPPPPXXXXXXXXXBLLLLLLLIIIILELLLDDDDDLLLAAIIIIIIIOOOOOOOOOORRRRRRRRRRRRRWWQQQQQNNNNNNNNVWWKKKKKQQQQQSSSSSSSSSSLLL
GGGGGGSGGGAAGXXXXXXXXXYYYYYYXXPXXXXXXXXXXXBBLLLLLLFFFILLLLLLLLLDLLLLLWWIHIHOOOOOOOOOOORRRRRRRRRRRRRWWQQQQQNNNNVNNVVWWWKKKKKKKQQSSSSRRRSSSSSS
GGGGGGGGGGGGGXXXXXXXXXXXXYYYXXXXXXXXXXXXXXXLLLLLLLFFLLLLLLLLLLLLLLLLWWWRHHHOOOOOOOOOOOOORRRRRRRRRRRWWWWWWNNNNNVVVVVVKKKKKKKKKKQQSRRRRRRRRSOO
GGGGGGGGGJJGGXXXXXXXXXXXXYYYXXXXXXXXXXXXXXLLLLLLLLFFLXLRRLLLLLLLLLLLRWRRHHHHOOOOOOOOOOORRRRRRRRRRRWWWWWWWNNNNNVVVVVVVVXKKKKKKKIIRRRRRNNNRNON
GGGGGGGGGJJJGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXLLXXXXXXXXXRRRRLLLLLLLLLRRRRRHHHOOOOOOOOOOOOMYRRRRRRRRRWWWWWWWNNNNNNVVVVVVVKKKKKKKIIIRIRRRNNNNNON
GGJGJJGJGJJJJVXXXXXXXXXXCXZXXXXXXXXXXXXXXXXXLWXXXXXXXXRRRRLLLLLLLLLLRRRRHHAAOOOOOOOOOOJYYRRRRRRRRWWWWWWWWNNNNNNVVVVVVVKKKVVVVIIIIIRRNNNNNNNN
GGJJJJJJJJJJJJOOXXYXXXXLLLZXXXXXXXXXXXXXXXXWWWXXXXXXXXXRRRSSSLSSLLLLLRRRRAAAMMMMOOOOOOYYYYSRRRRWWWWJJWWWWWJNNNNVVVVVVVVVKVVVVIIIIIIIFNNNNNNN
GGGGJJJJJJJJJJJXXXXXXXLLLLLXXXXXXXXXXXXXXXXWWWXXXXXXXXXXXXSSSSSSSSLLRRRRRAAAAOOOOOOOOYYYYYYRYRYWYWWJJJJJJJJYYYVVVVVVVVVCKVVVVIIIIIIIINNNNNNN
GGGJJJJJJJJJJJLXXLXXXLLLLLLLXXXXXXXXXXXXWXXWWWWXXXXXXXXXXDDNNNSSSRRRRRDAAAAAOOOOOFOOYYYYYYYYVVVVVYJJJJJJJJJYYYVVVVVVVVVCSSSSSSSSSSSSSNNNNNNN
GGJJJJJJJJJJJJLLLLLXLLLYYYLLXXXXXXXXXXXXWXWWWWXXXXXXXXXXXXXXNNNSSSRRRRAAAAAOOOAOOOOOOYYYYYYYVVVVVJJJJSSSSSSSSSSVVVVVVVVVSSSSSSSSSSSSRRNNNNNN
GGGJJJJJJJJJJJJLLLLLLYLLYYFLXXXXXXXXXXWWWWWWWXXXXXXXXXXXXXXXNNNNSRRRRRAAAAAAAAAAOOOYYYYYYYYYVVVVVVJJJSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSRNNNNNNN
GGGJJJJJJJJJJJJLLLLLLYYYYYFFXXXXYXHXXXXXWWWWWWWXXXXXXXXXXXXSNNNNSSRRRRRSFFFAAAAAAAAYYYYYYYYYVVVVVVVVVSSSSSSSSSSSSSSSSSSSSSSRRIIIIBRRRNNNNNNN
GJJJJJJJJJJJJLLLLLLLYYYYYYYFFXWWNNNXXXXXWWWWWWXXXXXXXXXXXXSFFFFFFFFFRSSSFFFAAAAAAASYYYYYYYYYVVVVVVVVVSSSSSSSSSSSSSSSSSSSSSSRRRRRIRRRRRNNNNNN
JJJJJJJJJJJJJLLLLLLYYYYYYYYFNNNNNNNXXXWWWWWWWWWXXXXXXXMVXXSFFFFFFFFFFFFFFFFAAAAAASSSSYYYYYYYVVVVVVVVVVVVSSSSSSSSSSSSSSSSSSSRRRRRRRRRRRRRNNNN
PJJJUJJJJLLJJLLLLLLLYYYYYYYYYNNNNNNXXXWWWWWWWWWWXXXXXXVVVXSFFFFFFFFFFFFFFFFFFFFFFFFFIUYYYYYYVVVVVVVVVVVVVVVSSSSSSSSSSSSSSSSCRRRRRRRRRRRRNNNN
JJJJJJJJJJLLLLLLLLLLLLYYYYNNNNNNNNNWWWWWWWWWWWWWXXXXXVVVSSSFFFFFFFFFFFFFFFFFFFFFFFFFUYYYYYYYVVVVVVVVVVVVVVVSSSSSSSSSSSSSSSSRRRRRRRRRRRRRWNNN
JJJJZZZAALLLLLLLLJLJLLYNNNNNNNNNNNNWWWWWWWWWWWWWXXXXXVVVVSSFFFFFFFFFSSFFFFFFFFFFFFFFUYYYYYYYYYCICJVVVVVVVVVSSSSSSSSSSSSSSSSRRRRRRRRRRRWWWNNW
JJJYAZAAAAALLJLLJJJJJJJNNNNNNNNFFFNWWWWWWWWWWXXXXXXVVVVVSSYFFFFFFFFFSSFFFFFFFFFFFFFFUUUYYYYYYYCCCCJJCRVVVVVVMMMMMMMMMMXXRRRRRRRRRRRLRRLWWWWW
AAJAAAAAAAAJJJLJJJJJNNNNNNNNNNFFFFFFFFWWWWWWXXXXXXXXVVVVSSSFFFFFFFFFSSSZFFFFFFFFFFFFIIUUYYYYCCCCCCCCCCJJJVVVMMMMMMMMMLMMMMMRRRRRRRRLRRLLLWWW
AAAAAXAAAAAJJJLJJJJTJJNNNNNNONNSFFFFFWWFFFNWXXXXXXXVVVVVSSYFFFFFFFFFZSSZFFFFFFFFFFFFIIIUYYYYZCCCCCCCCCBBJVVVWMMMMMMMMMMMMMMMRRRRRRLLLLLLLWWL
EEAAAAAAAAAJJJJJJJJJJJNNNNNNONNNFFFFFFWFNFNNNNXXXXXXVVVVVVVYYHUUUUUZZZSZZZFFFFFFFFFFZIIIYYYTTTCCCCCCCBBCHVVVWWWMMMMMMMMMMMMMRRRRRRLLLLLLLLLL
EEAAAAAAAAAJJJJJJJQQNNNNNNNNOOFFFFFFFFNFNFNNNNNXXXVVVVVVVVVYYUUUUUUUZZZZZZZZZIZZZZZZZIITTYTTTTCCCCCCCCCCHVVVWWWWWMMMMMMMMMMMMRRRRLLLLLLLLLLL
EEAAAAAAAAJJDJJJJJJQQNNNNNNNOOFFFFFFFFNNNNNNNNXXXXVVVVVVVVVYYYUUUUUZZZZZZZZZIIZZZZZZZSTTTYTTTCCCCCCCFCCHHVVVEWWWWMMMMMMMMMMMMMRRRRLLLLLLLLLL
EAAAAAAAAAJDDJJJJJJQQQQNNNNNOOFFFFFFFFNFFNNNNNXXXXVVVVVVVVVYYYUUUUUUZZZZZZZZZIZZZZZZZSSTTTTTTCCCCCCCCCCCHVVVWWWWMMMMMMMMMZZZRRRRRRRLLLLLLLLL
EEEAAAAAAJJJJJJJJJJJQQQQNNNNFFFFFFFFFFFFFNNNXXXXXXVVVVVVVVVYYUUUUUUUZZZZZZZZZIZZZZZZZSSTTTTTTCCCCCCCCCEEEVVVWWWWWMMMMMMMMZZZRZRRRRLLLLLLLLLL
EEEAAAAAAABJJJJJJJJQQQQQQNFFFFFFFFFFFFFFFNNNXXXXXXXVVVVVVYYYYYYUEEUZZZZZZZZZZZZZZZZZZZZZZTTTTCCCCCCCCCEEEVVVWWWWWWMMMMMMZZZZZZZRRRLLLLLLLLLL
EEEEAAAAAAAJJJJJJJJJQQQQQNNNFFFFFFFFFFFFFXXXXXXXXXXXVUVVVVYYYYYYZZZZZZZZZZZZZZZZZZZZZZZZZTTTTCCCCCCCCCEERREMRRRWWMMMMMZZZZZZZZZZRRLLLLLLLLLL
EEEEEAAAAAAAAJJJJTJQQQQQQNNFFKKFFFFFFFCCCCXXXXXXXXXXVVVVVYYYYYYYZZZZZZZZZZZZZZSZZZZZZZZZZTTTCCCCCCCCCCERRRRRRRRWWWWMMMZZZZZZZZZRRRLILLLLLLLL
EEEEAAAAAAAAPPPJJRQQQQQQQQQKKKKKKFFFFFFCCCCXXXXXXXXXXXYVVYYYYYYYZZZZZZZZZZZOZZZZZZZZZZZZZTTTTCCCCCCCCEERRRRRRRRRRWWMMMZZZZZZZZZZIIIIIILLLLLL
EEEEAAAQCCAAPPPPRRRRQQQQQQQKGGKXKFFFFCCCCCCCXXXXXXXYYYYYYYYYYYYZZZZZZZZZZZZSZZZZZZZZZZZZZTTTCCCCCEEEEEEEERRRRRRRRRWWWMZZZZZZZZZZZIIIIIILLLLL
EEEEEEECCCCPPPPPRRRURQQRQQQKGKKKKKKFCCCCCCCCCCCCCCXXXYYYYYYYYYYYYZZZZZZZZZZZZZZZZZZZZZZZZTTTCTTTCEEEEEEERRRRRRRRRRWWWWZZZZZZZZZZIIIIIIILILLL
EEEEEEECCCCPPPPRRRRRRRRRQQQKKKKKKKKCCCCCCCCCCCCCCCCNYYYYYYYYYYYZZZZZZZZZZZZZZZZZZZZZZZZZZSTTTTTTTTTEEEEERRRRRRRRRRRWWWZZZZZZZZZZIIIIIIAIILLL
EEEEEEEEEEEEPPRRRRRRRRRRQQQKKKKKKKKXXCCCCCCCCCCNCCCNYYYYYYYYYYYZZZZZZZZZZZZZZZZZZZZZZZZZZSSTTSTTSSEEEEEERRERRRRRRRXWWZZZZZZZZZAZIIIIIIIIIILL
EEEEEEEEEEEKRRRRRRRRRRLRKKKKKKKKKCXXXCCCCCCCCCCNCCCNYYYYYYYYYYYZZZZZXXZZXXXXZZZZQSSSSSSSTTTTSSSSSSSSEEEEEEERLRRRRRWWWWWZZZZSZZZIIIIIIIIIXXXL
EEEEEEEEEEFRRRRRRRRRRRRTKKKKKKKKCCCXXCCCCCCCCCCNNNNNNXXXXXXYYYYYQQUXXXXXXXXXZZZZZZZZZZSSSTTTSSSSSSSSSEEEEELLLLRRRRRWWJPZSSSSZZIIIIIIIIIIXXXX
EEEMEEEEEEFFFRRRRRRRRRTTKKEKKKKKKCCCCCCCCCCCCCNNNNNNXXXXXXXXXXXXQQUXXXXXXXXXZZZZZZZZZZSSCTTTTUSSSSSSEEEEEELLRRRRRRRJJJJSSSZZZZIIIIIIIIIIXXXX
EEEMMEEEEEFFRRRRRRRRRRRKKKKKKCKCCCCCWCCCCCCCCCCCNNNNNNNXXXXXXXXXQQQQXXXXXXXXZZZZZZZZZZSCCTTTTTTEESSEEEEEEEEEERRRJRRJJJJJSSSZZSIIIIIIIIIIXXXX
MMMMMMMMEEERRRRRRRRRRRDDDKKKKCCCCCCCCCCCCCCCCCNNNNNNNNNNXXXXXXXQQQQQQQXXXXXXXXOZZZZZZZSSSTTTTTTEEEEEEEEEEEEEEREJJAJJJJJJSJSSSSIIIIIIIIIXXXXX
MMMMMMMMEKKRRRRRRRRRRRDDDDKKKCCCCCCCHCCCCCCCCCNNNNNNNNNNXXXXXXXQQQQQQQNNXXXXXXOZZZZZZZSSRTTTTTTEEEEEEEEEEEEEEEEJJJJJJJJJJJSSSSSIIIIIIIXXXXXX
OMMMMMMKKKKKRRRRRRRRRRDDDDKKKKCJCCCCHCCCCCCCCCCNNNNNNNXXXXXXXXXQQQQQQQQQQXXXXXOZZZZZZZIITTTTTTTTTEEEEEEEEEEEEEEEEJJJJJJJJJSSSSIIIIIIIIXXXXXX
OOOMMMKKKKKKKRRRRHRRRDDDDDKKKCCCCRCHHHHCCCCCCCCCNNNNNNNXXXXXXXQQQQQQQQQQQQQXXXXOOOOOIIIIITTTTTTEEEEEEEEEEEEEEEEEEJJJJJJJJSSSSSSSIIIIXXXXXXXX"""

data = """RRRRIICCFF
RRRRIICCCF
VVRRRCCFFF
VVRCCCJFFF
VVVVCJJCFE
VVIVCCJJEE
VVIIICJJEE
MIIIIIJJEE
MIIISIJEEE
MMMISSJEEE"""


PART1 = False

data = data.split("\n")

from collections import deque
import pprint
def in_bounds(i, j):
    return i >= 0 and i < len(data) and j >= 0 and j < len(data[0])

def get_neighbours(i, j):
    letter = data[i][j]
    neighbours = []
    for di, dj in [(1, 0), (0, 1), (-1, 0), (0, -1)]:
        if in_bounds(i + di, j + dj) and data[i + di][j + dj] == letter:
            neighbours.append((i+di, j+dj))
    return neighbours

seen = set()
total = 0

def calculate_num_sides(area, l):
    max_i = 0
    min_i = len(data[0])
    max_j = 0
    min_j = len(data[0])
    for i,j in area:
        if i > max_i:
            max_i = i
        if j > max_j:
            max_j = j
        if i < min_i:
            min_i = i
        if j < min_j:
            min_j = j
    num_sides = 0
    prevs = []
    for row in range(min_i, max_i+1):
        cont = False
        next_prevs = []
        for col in range(min_j, max_j + 1):
            if (row, col) in area:
                if not cont:
                    start = (row, col)
                    next_start = (row+1, col)
                    if (row, col) not in [prev[0] for prev in prevs]:
                        num_sides += 1
                    cont = True
            else:
                if cont:
                    end = (row, col)
                    next_end = (row+1, col)
                    if end not in [prev[1] for prev in prevs]:
                        num_sides += 1
                    next_prevs.append((next_start, next_end))
                cont = False
        if cont:
            if (-1, -1) not in [prev[1] for prev in prevs]:
                num_sides += 1
            
            next_prevs.append((next_start, (-1, -1)))
        prevs = next_prevs
    
    prevs = []
    for col in range(min_j, max_j + 1):
        cont = False
        next_prevs = []
        for row in range(min_i, max_i+1):
            if (row, col) in area:
                if not cont:
                    start = (row, col)
                    next_start = (row, col+1)
                    if (row, col) not in [prev[0] for prev in prevs]:
                        num_sides += 1
                    cont = True
            else:
                if cont:
                    end = (row, col)
                    next_end = (row, col+1)
                    if end not in [prev[1] for prev in prevs]:
                        num_sides += 1
                    next_prevs.append((next_start, next_end))
                cont = False
        if cont:
            if (-1, -1) not in [prev[1] for prev in prevs]:
                num_sides += 1
            next_prevs.append((next_start, (-1, -1)))
        prevs = next_prevs
    return num_sides
                    
for i in range(len(data)):
    for j in range(len(data[0])):
        if (i, j) not in seen:
            dc = [[' '] * len(data[0]) for _ in data]
            queue = deque()
            queue.append((i, j))
            area = 0
            perim = 0
            seen.add((i, j))
            cells = set()
            cells.add((i, j))
            while queue:
                ci, cj = queue.popleft()
                neighbours = get_neighbours(ci, cj)
                area += 1
                perim += 4 - len(neighbours)
                for neighbour in neighbours:
                    if neighbour not in seen:
                        seen.add(neighbour)
                        cells.add(neighbour)
                        queue.append(neighbour)
            num_sides = calculate_num_sides(cells, data[i][j])
            if PART1:
                total += area * perim
            else:
                total += area * num_sides
   
print(total)